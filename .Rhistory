library(treeducken)
?sim_locustree_bdp
?calculate_expected_leaves_locustree
compare_mean_leaf_number <- function(tree_set,
gene_birth_rate,
gene_death_rate,
fixed_depth){
speciesTree <- treeducken::sim_sptree_bdp_time(sbr = 0.1,
sdr = 0.05,
numbsim = 1,
t = fixed_depth)
numberSpeciesTips <- length(speciesTree$tip.label)
locusTreeSet <- treeducken::sim_locustree_bdp(species_tree = speciesTree,
gbr = gene_birth_rate,
gdr = gene_death_rate,
lgtr = 0.0,
num_loci = 10000)
expectedValue <- treeducken::calculate_expected_leaves_locustree(t = fixed_depth,
dup_rate = gene_birth_rate,
loss_rate = gene_death_rate,
num_species = numberSpeciesTips)
vectorOfNumberLoci <- vector(length = 10000)
for(i in 1:10000){
vectorOfNumberLoci[i] <- length(locusTreeSet[[i]]$tip.label)
}
(mean(vectorOfNumberLoci) - expectedValue) / sqrt(var(vectorOfNumberLoci))
}
source('~/projects/r_projects/treeduckenValidation/R/locus_test.R', echo=TRUE)
compare_mean_leaf_number(0.1, 0.04, 2.0)
source('~/projects/r_projects/treeduckenValidation/R/locus_test.R', echo=TRUE)
compare_mean_leaf_number(0.1, 0.04, 2.0)
source('~/projects/r_projects/treeduckenValidation/R/locus_test.R', echo=TRUE)
compare_mean_leaf_number(0.1, 0.04, 2.0)
source('~/projects/r_projects/treeduckenValidation/R/locus_test.R', echo=TRUE)
compare_mean_leaf_number(0.1, 0.04, 2.0)
source('~/projects/r_projects/treeduckenValidation/R/locus_test.R', echo=TRUE)
compare_mean_leaf_number(0.1, 0.04, 2.0)
?treeducken::calculate_expected_leaves_sptree
source('~/projects/r_projects/treeduckenValidation/R/sptree_tests.R', echo=TRUE)
compare_sptree_mean_leaf_number(0.1,0.05,1.0,10000)
?treeducken::sim_sptree_bdp
?treeducken::estimate_node_heights
?ape::node.depth
source('~/projects/r_projects/treeduckenValidation/R/sptree_tests.R', echo=TRUE)
compare_sptree_node_depth(0.1,0.05,50,10000)
?TreeSim
??TreeSim
source('~/projects/r_projects/treeduckenValidation/R/sptree_tests.R', echo=TRUE)
source('~/projects/r_projects/treeduckenValidation/R/sptree_tests.R', echo=TRUE)
compare_sptree_node_depth(0.1,0.05,50,10000)
source('~/projects/r_projects/treeduckenValidation/R/sptree_tests.R', echo=TRUE)
compare_sptree_node_depth(0.1,0.05,50,10000)
source('~/projects/r_projects/treeduckenValidation/R/sptree_tests.R', echo=TRUE)
compare_sptree_node_depth(0.1,0.05,50,10000)
source('~/projects/r_projects/treeduckenValidation/R/sptree_tests.R', echo=TRUE)
compare_sptree_node_depth(0.1,0.05,50,10000)
?TreeSim
View(compare_mean_leaf_number)
